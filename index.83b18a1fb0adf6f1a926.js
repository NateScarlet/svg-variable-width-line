!function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){t.exports=r(1)},function(t,e,r){"use strict";r.r(e);var n={};r.r(n),r.d(n,"translatePoint",(function(){return u})),r.d(n,"refineFloat",(function(){return a}));var o={};r.r(o),r.d(o,"length",(function(){return c}));var i={};function u(t,e){var r=t.getScreenCTM();if(!r)throw new Error("Should has screen CTM.");var n=t.createSVGPoint();return n.x=e.x,n.y=e.y,n.matrixTransform(r.inverse())}function a(t){return t+8-8}function c(){for(var t=0,e=1;e<arguments.length;e+=1){var r=e-1<0||arguments.length<=e-1?void 0:arguments[e-1],n=e<0||arguments.length<=e?void 0:arguments[e];t+=Math.sqrt(Math.pow(r.x-n.x,2)+Math.pow(r.y-n.y,2))}return t}function s(t,e){var r=t.w/2;if(!e)return{left:{x:t.x,y:t.y+r},right:{x:t.x,y:t.y-r}};var n=Math.atan((t.y-e.y)/(t.x-e.x)),o=a(Math.sin(n)*r),i=a(Math.cos(n)*r);return{left:{x:t.x-o,y:t.y+i},right:{x:t.x+o,y:t.y-i}}}function l(){for(var t=["M"],e=[],r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];for(var i=0;i<n.length;i+=1){var u=s(n[i],n[i-1]||n[i+1]),a=u.left,l=u.right,f=e.slice(i)[0];f&&c(f,a)>c(f,l)?e.splice(i,0,a,l):e.splice(i,0,l,a)}for(var p=0,h=e;p<h.length;p++){var y=h[p];t.push("".concat(y.x,",").concat(y.y))}var v=t.join(" ");return{d:v}}function f(t){return function(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function p(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function h(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?p(Object(r),!0).forEach((function(e){y(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function y(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function v(){var t,e=[];if(0===arguments.length)return[];e.push(h({},arguments.length<=0?void 0:arguments[0]));for(var r=0;r<arguments.length-1;r++){var n=r<0||arguments.length<=r?void 0:arguments[r],o=r+1<0||arguments.length<=r+1?void 0:arguments[r+1];e.push({x:.75*n.x+.25*o.x,y:.75*n.y+.25*o.y,w:.75*n.w+.25*o.w},{x:.25*n.x+.75*o.x,y:.25*n.y+.75*o.y,w:.25*n.w+.75*o.w})}arguments.length>2&&e.push(h({},(t=arguments.length-1)<0||arguments.length<=t?void 0:arguments[t]));return e}function d(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=t,n=0;n<e;n+=1)r=v.apply(void 0,f(r));return r}function g(t){return function(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function b(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function w(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function m(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}r.r(i),r.d(i,"computeSidePoints",(function(){return s})),r.d(i,"compute",(function(){return l})),r.d(i,"util",(function(){return n})),r.d(i,"vector2",(function(){return o})),r.d(i,"smoothOnce",(function(){return v})),r.d(i,"smooth",(function(){return d}));var O=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.isDrawing=!1,this.points=[],this.width=20,this.el=e}var e,r,u;return e=t,(r=[{key:"onPointerdown",value:function(t){t.preventDefault(),this.isDrawing=!0,this.points=[];var e=document.createElementNS("http://www.w3.org/2000/svg","path");this.el.appendChild(e),this.target=e}},{key:"onPointermove",value:function(t){var e=this;if(this.isDrawing&&(t.preventDefault(),!(this.lastDrawTime&&Date.now()-this.lastDrawTime<4))){this.lastDrawTime=Date.now();var r=n.translatePoint(this.el,t),i={x:r.x,y:r.y,w:t.pressure*this.width},u=this.points.slice(-1)[0];u&&o.length(u,i)<this.width||(this.points.push(i),"mouse"===t.pointerType&&(this.points=this.points.map((function(t,r,n){return function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?b(Object(r),!0).forEach((function(e){w(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},t,{w:e.width*(r/n.length)})}))),this.update())}}},{key:"onPointerup",value:function(t){t.preventDefault(),this.isDrawing=!1,delete this.target}},{key:"install",value:function(){this.el.addEventListener("pointerdown",this.onPointerdown.bind(this)),this.el.addEventListener("pointermove",this.onPointermove.bind(this)),this.el.addEventListener("pointerup",this.onPointerup.bind(this))}},{key:"update",value:function(){var t=l.apply(i,g(d(this.points,4))).d;this.mustTarget.setAttribute("d",t)}},{key:"mustTarget",get:function(){if(!this.target)throw new Error("Should has target");return this.target}}])&&m(e.prototype,r),u&&m(e,u),t}();!function(){var t=document.querySelector("svg#canvas");if(!(t instanceof SVGSVGElement))throw Error("Missing canvas element");new O(t).install(),t.addEventListener("pointermove",(function(t){var e=document.querySelector("#pressure");e&&(e.textContent=t.pressure.toString())})),t.addEventListener("pointermove",(function(t){var e=document.querySelector("#pointer-type");e&&(e.textContent=t.pointerType)}))}()}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWxzL3RyYW5zbGF0ZVBvaW50LnRzIiwid2VicGFjazovLy8uL3NyYy91dGlscy9yZWZpbmVGbG9hdC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvdmVjdG9yMi9sZW5ndGgudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXB1dGUudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3Ntb290aC50cyIsIndlYnBhY2s6Ly8vLi9kZW1vL2luZGV4LnRzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwidHJhbnNsYXRlUG9pbnQiLCJlbCIsInBvaW50IiwibWF0cml4IiwiZ2V0U2NyZWVuQ1RNIiwiRXJyb3IiLCJjcmVhdGVTVkdQb2ludCIsIngiLCJ5IiwibWF0cml4VHJhbnNmb3JtIiwiaW52ZXJzZSIsInJlZmluZUZsb2F0IiwidiIsInJldCIsImxlbmd0aCIsInBhIiwicGIiLCJNYXRoIiwic3FydCIsInBvdyIsImNvbXB1dGVTaWRlUG9pbnRzIiwiY3VycmVudCIsInByZXYiLCJ3IiwibGVmdCIsInJpZ2h0IiwiYW5nbGUiLCJhdGFuIiwiZHgiLCJzaW4iLCJkeSIsImNvcyIsImNvbXB1dGUiLCJvcGVyYXRpb25zIiwiZWRnZVBvaW50cyIsInBvaW50cyIsImxhc3RMZWZ0Iiwic2xpY2UiLCJzcGxpY2UiLCJwdXNoIiwiam9pbiIsInNtb290aE9uY2UiLCJwMCIsInAxIiwic21vb3RoIiwidGltZXMiLCJjb3VudCIsImlzRHJhd2luZyIsIndpZHRoIiwidGhpcyIsImUiLCJwcmV2ZW50RGVmYXVsdCIsInRhcmdldCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudE5TIiwiYXBwZW5kQ2hpbGQiLCJsYXN0RHJhd1RpbWUiLCJEYXRlIiwibm93IiwicHJlc3N1cmUiLCJsYXN0UG9pbnQiLCJwb2ludGVyVHlwZSIsIm1hcCIsImFycmF5IiwidXBkYXRlIiwiYWRkRXZlbnRMaXN0ZW5lciIsIm9uUG9pbnRlcmRvd24iLCJvblBvaW50ZXJtb3ZlIiwib25Qb2ludGVydXAiLCJtdXN0VGFyZ2V0Iiwic2V0QXR0cmlidXRlIiwicXVlcnlTZWxlY3RvciIsIlNWR1NWR0VsZW1lbnQiLCJpbnN0YWxsIiwidGV4dENvbnRlbnQiLCJ0b1N0cmluZyJdLCJtYXBwaW5ncyI6ImFBQ0UsSUFBSUEsRUFBbUIsR0FHdkIsU0FBU0MsRUFBb0JDLEdBRzVCLEdBQUdGLEVBQWlCRSxHQUNuQixPQUFPRixFQUFpQkUsR0FBVUMsUUFHbkMsSUFBSUMsRUFBU0osRUFBaUJFLEdBQVksQ0FDekNHLEVBQUdILEVBQ0hJLEdBQUcsRUFDSEgsUUFBUyxJQVVWLE9BTkFJLEVBQVFMLEdBQVVNLEtBQUtKLEVBQU9ELFFBQVNDLEVBQVFBLEVBQU9ELFFBQVNGLEdBRy9ERyxFQUFPRSxHQUFJLEVBR0pGLEVBQU9ELFFBS2ZGLEVBQW9CUSxFQUFJRixFQUd4Qk4sRUFBb0JTLEVBQUlWLEVBR3hCQyxFQUFvQlUsRUFBSSxTQUFTUixFQUFTUyxFQUFNQyxHQUMzQ1osRUFBb0JhLEVBQUVYLEVBQVNTLElBQ2xDRyxPQUFPQyxlQUFlYixFQUFTUyxFQUFNLENBQUVLLFlBQVksRUFBTUMsSUFBS0wsS0FLaEVaLEVBQW9Ca0IsRUFBSSxTQUFTaEIsR0FDWCxvQkFBWGlCLFFBQTBCQSxPQUFP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MThhMWZiMGFkZjZmMWE5MjYuanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMCk7XG4iLCJleHBvcnQgZnVuY3Rpb24gdHJhbnNsYXRlUG9pbnQoXG4gIGVsOiBTVkdTVkdFbGVtZW50LFxuICBwb2ludDogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9XG4pOiBET01Qb2ludCB7XG4gIGNvbnN0IG1hdHJpeCA9IGVsLmdldFNjcmVlbkNUTSgpO1xuXG4gIGlmICghbWF0cml4KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdTaG91bGQgaGFzIHNjcmVlbiBDVE0uJyk7XG4gIH1cbiAgY29uc3QgcCA9IGVsLmNyZWF0ZVNWR1BvaW50KCk7XG4gIHAueCA9IHBvaW50Lng7XG4gIHAueSA9IHBvaW50Lnk7XG4gIHJldHVybiBwLm1hdHJpeFRyYW5zZm9ybShtYXRyaXguaW52ZXJzZSgpKTtcbn1cbiIsIi8qKiBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL2EvNDM1NTAyNjggKi9cbmV4cG9ydCBmdW5jdGlvbiByZWZpbmVGbG9hdCh2OiBudW1iZXIpOiBudW1iZXIge1xuICByZXR1cm4gdiArIDggLSA4O1xufVxuIiwiaW1wb3J0IHsgVmVjdG9yMiB9IGZyb20gJy4uL3R5cGVzJztcblxuLyoqIExlbmd0aCBiZXR3ZWVuIHBvaW50cyAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxlbmd0aCguLi5wb2ludHM6IFZlY3RvcjJbXSk6IG51bWJlciB7XG4gIGxldCByZXQgPSAwO1xuICBmb3IgKGxldCBpID0gMTsgaSA8IHBvaW50cy5sZW5ndGg7IGkgKz0gMSkge1xuICAgIGNvbnN0IHBhID0gcG9pbnRzW2kgLSAxXTtcbiAgICBjb25zdCBwYiA9IHBvaW50c1tpXTtcbiAgICByZXQgKz0gTWF0aC5zcXJ0KE1hdGgucG93KHBhLnggLSBwYi54LCAyKSArIE1hdGgucG93KHBhLnkgLSBwYi55LCAyKSk7XG4gIH1cbiAgcmV0dXJuIHJldDtcbn1cbiIsImltcG9ydCB7IFBvaW50LCBWZWN0b3IyIH0gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQgeyByZWZpbmVGbG9hdCB9IGZyb20gJy4vdXRpbHMvcmVmaW5lRmxvYXQnO1xuaW1wb3J0ICogYXMgdmVjdG9yMiBmcm9tICcuL3ZlY3RvcjInO1xuXG5leHBvcnQgZnVuY3Rpb24gY29tcHV0ZVNpZGVQb2ludHMoXG4gIGN1cnJlbnQ6IFBvaW50LFxuICBwcmV2PzogUG9pbnRcbik6IHsgbGVmdDogVmVjdG9yMjsgcmlnaHQ6IFZlY3RvcjIgfSB7XG4gIGNvbnN0IHIgPSBjdXJyZW50LncgLyAyO1xuICBpZiAoIXByZXYpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbGVmdDoge1xuICAgICAgICB4OiBjdXJyZW50LngsXG4gICAgICAgIHk6IGN1cnJlbnQueSArIHIsXG4gICAgICB9LFxuICAgICAgcmlnaHQ6IHtcbiAgICAgICAgeDogY3VycmVudC54LFxuICAgICAgICB5OiBjdXJyZW50LnkgLSByLFxuICAgICAgfSxcbiAgICB9O1xuICB9XG4gIGNvbnN0IGFuZ2xlID0gTWF0aC5hdGFuKChjdXJyZW50LnkgLSBwcmV2LnkpIC8gKGN1cnJlbnQueCAtIHByZXYueCkpO1xuICBjb25zdCBkeCA9IHJlZmluZUZsb2F0KE1hdGguc2luKGFuZ2xlKSAqIHIpO1xuICBjb25zdCBkeSA9IHJlZmluZUZsb2F0KE1hdGguY29zKGFuZ2xlKSAqIHIpO1xuICByZXR1cm4ge1xuICAgIGxlZnQ6IHtcbiAgICAgIHg6IGN1cnJlbnQueCAtIGR4LFxuICAgICAgeTogY3VycmVudC55ICsgZHksXG4gICAgfSxcbiAgICByaWdodDoge1xuICAgICAgeDogY3VycmVudC54ICsgZHgsXG4gICAgICB5OiBjdXJyZW50LnkgLSBkeSxcbiAgICB9LFxuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY29tcHV0ZSguLi5wb2ludHM6IFBvaW50W10pOiB7IGQ6IHN0cmluZyB9IHtcbiAgY29uc3Qgb3BlcmF0aW9uczogc3RyaW5nW10gPSBbJ00nXTtcbiAgY29uc3QgZWRnZVBvaW50czogVmVjdG9yMltdID0gW107XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgcG9pbnRzLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgY29uc3QgeyBsZWZ0LCByaWdodCB9ID0gY29tcHV0ZVNpZGVQb2ludHMoXG4gICAgICBwb2ludHNbaV0sXG4gICAgICBwb2ludHNbaSAtIDFdIHx8IHBvaW50c1tpICsgMV1cbiAgICApO1xuICAgIGNvbnN0IGxhc3RMZWZ0ID0gZWRnZVBvaW50cy5zbGljZShpKVswXTtcbiAgICBpZiAoXG4gICAgICBsYXN0TGVmdCAmJlxuICAgICAgdmVjdG9yMi5sZW5ndGgobGFzdExlZnQsIGxlZnQpID4gdmVjdG9yMi5sZW5ndGgobGFzdExlZnQsIHJpZ2h0KVxuICAgICkge1xuICAgICAgZWRnZVBvaW50cy5zcGxpY2UoaSwgMCwgbGVmdCwgcmlnaHQpO1xuICAgIH0gZWxzZSB7XG4gICAgICBlZGdlUG9pbnRzLnNwbGljZShpLCAwLCByaWdodCwgbGVmdCk7XG4gICAgfVxuICB9XG4gIGZvciAoY29uc3QgcCBvZiBlZGdlUG9pbnRzKSB7XG4gICAgb3BlcmF0aW9ucy5wdXNoKGAke3AueH0sJHtwLnl9YCk7XG4gIH1cbiAgY29uc3QgZCA9IG9wZXJhdGlvbnMuam9pbignICcpO1xuICByZXR1cm4geyBkIH07XG59XG4iLCJpbXBvcnQgeyBQb2ludCB9IGZyb20gJy4vdHlwZXMnO1xuXG4vLyBSZWZlcjogaHR0cHM6Ly9naXRodWIuY29tL0phbTMvY2hhaWtpbi1zbW9vdGgvYmxvYi9tYXN0ZXIvaW5kZXguanNcblxuZXhwb3J0IGZ1bmN0aW9uIHNtb290aE9uY2UoLi4ucG9pbnRzOiBQb2ludFtdKTogUG9pbnRbXSB7XG4gIGNvbnN0IHJldDogUG9pbnRbXSA9IFtdO1xuICBpZiAocG9pbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiBbXTtcbiAgfVxuICByZXQucHVzaCh7IC4uLnBvaW50c1swXSB9KTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBwb2ludHMubGVuZ3RoIC0gMTsgaSsrKSB7XG4gICAgY29uc3QgcDAgPSBwb2ludHNbaV07XG4gICAgY29uc3QgcDEgPSBwb2ludHNbaSArIDFdO1xuXG4gICAgcmV0LnB1c2goXG4gICAgICB7XG4gICAgICAgIHg6IDAuNzUgKiBwMC54ICsgMC4yNSAqIHAxLngsXG4gICAgICAgIHk6IDAuNzUgKiBwMC55ICsgMC4yNSAqIHAxLnksXG4gICAgICAgIHc6IHAwLncgKiAwLjc1ICsgcDEudyAqIDAuMjUsXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICB4OiAwLjI1ICogcDAueCArIDAuNzUgKiBwMS54LFxuICAgICAgICB5OiAwLjI1ICogcDAueSArIDAuNzUgKiBwMS55LFxuICAgICAgICB3OiBwMC53ICogMC4yNSArIHAxLncgKiAwLjc1LFxuICAgICAgfVxuICAgICk7XG4gIH1cbiAgaWYgKHBvaW50cy5sZW5ndGggPiAyKSB7XG4gICAgcmV0LnB1c2goeyAuLi5wb2ludHNbcG9pbnRzLmxlbmd0aCAtIDFdIH0pO1xuICB9XG4gIHJldHVybiByZXQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzbW9vdGgocG9pbnRzOiBQb2ludFtdLCB0aW1lcyA9IDEpOiBQb2ludFtdIHtcbiAgbGV0IHJldCA9IHBvaW50cztcbiAgZm9yIChsZXQgY291bnQgPSAwOyBjb3VudCA8IHRpbWVzOyBjb3VudCArPSAxKSB7XG4gICAgcmV0ID0gc21vb3RoT25jZSguLi5yZXQpO1xuICB9XG4gIHJldHVybiByZXQ7XG59XG4iLCJpbXBvcnQgKiBhcyBzdmdWYXJpYWJsZVdpZHRoTGluZSBmcm9tICdAJztcbmltcG9ydCB7IFBvaW50IH0gZnJvbSAnQCc7XG5cbmNsYXNzIERyYXdpbmdIYW5kbGVyIHtcbiAgcHVibGljIGVsOiBTVkdTVkdFbGVtZW50O1xuICBwdWJsaWMgaXNEcmF3aW5nID0gZmFsc2U7XG4gIHB1YmxpYyBwb2ludHM6IHN2Z1ZhcmlhYmxlV2lkdGhMaW5lLlBvaW50W10gPSBbXTtcbiAgcHVibGljIHRhcmdldD86IFNWR1BhdGhFbGVtZW50O1xuICBwdWJsaWMgd2lkdGggPSAyMDtcbiAgcHVibGljIGxhc3REcmF3VGltZT86IG51bWJlcjtcblxuICBwdWJsaWMgY29uc3RydWN0b3IoZWw6IFNWR1NWR0VsZW1lbnQpIHtcbiAgICB0aGlzLmVsID0gZWw7XG4gIH1cbiAgb25Qb2ludGVyZG93bihlOiBQb2ludGVyRXZlbnQpOiB2b2lkIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgdGhpcy5pc0RyYXdpbmcgPSB0cnVlO1xuICAgIHRoaXMucG9pbnRzID0gW107XG4gICAgY29uc3QgdGFyZ2V0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKFxuICAgICAgJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyxcbiAgICAgICdwYXRoJ1xuICAgICk7XG4gICAgdGhpcy5lbC5hcHBlbmRDaGlsZCh0YXJnZXQpO1xuICAgIHRoaXMudGFyZ2V0ID0gdGFyZ2V0O1xuICB9XG4gIGdldCBtdXN0VGFyZ2V0KCk6IFNWR1BhdGhFbGVtZW50IHtcbiAgICBpZiAoIXRoaXMudGFyZ2V0KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Nob3VsZCBoYXMgdGFyZ2V0Jyk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLnRhcmdldDtcbiAgfVxuICBvblBvaW50ZXJtb3ZlKGU6IFBvaW50ZXJFdmVudCk6IHZvaWQge1xuICAgIGlmICghdGhpcy5pc0RyYXdpbmcpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGlmICh0aGlzLmxhc3REcmF3VGltZSAmJiBEYXRlLm5vdygpIC0gdGhpcy5sYXN0RHJhd1RpbWUgPCA0KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMubGFzdERyYXdUaW1lID0gRGF0ZS5ub3coKTtcbiAgICBjb25zdCB7IHgsIHkgfSA9IHN2Z1ZhcmlhYmxlV2lkdGhMaW5lLnV0aWwudHJhbnNsYXRlUG9pbnQodGhpcy5lbCwgZSk7XG4gICAgY29uc3QgdyA9IGUucHJlc3N1cmUgKiB0aGlzLndpZHRoO1xuICAgIGNvbnN0IHA6IFBvaW50ID0geyB4LCB5LCB3IH07XG4gICAgY29uc3QgbGFzdFBvaW50ID0gdGhpcy5wb2ludHMuc2xpY2UoLTEpWzBdO1xuICAgIGlmIChcbiAgICAgIGxhc3RQb2ludCAmJlxuICAgICAgc3ZnVmFyaWFibGVXaWR0aExpbmUudmVjdG9yMi5sZW5ndGgobGFzdFBvaW50LCBwKSA8IHRoaXMud2lkdGhcbiAgICApIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5wb2ludHMucHVzaChwKTtcbiAgICBpZiAoZS5wb2ludGVyVHlwZSA9PT0gJ21vdXNlJykge1xuICAgICAgdGhpcy5wb2ludHMgPSB0aGlzLnBvaW50cy5tYXAoKHYsIGksIGFycmF5KSA9PiAoe1xuICAgICAgICAuLi52LFxuICAgICAgICB3OiB0aGlzLndpZHRoICogKGkgLyBhcnJheS5sZW5ndGgpLFxuICAgICAgfSkpO1xuICAgIH1cbiAgICB0aGlzLnVwZGF0ZSgpO1xuICB9XG4gIG9uUG9pbnRlcnVwKGU6IFBvaW50ZXJFdmVudCk6IHZvaWQge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB0aGlzLmlzRHJhd2luZyA9IGZhbHNlO1xuICAgIGRlbGV0ZSB0aGlzLnRhcmdldDtcbiAgfVxuICBpbnN0YWxsKCk6IHZvaWQge1xuICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcigncG9pbnRlcmRvd24nLCB0aGlzLm9uUG9pbnRlcmRvd24uYmluZCh0aGlzKSk7XG4gICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKCdwb2ludGVybW92ZScsIHRoaXMub25Qb2ludGVybW92ZS5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ3BvaW50ZXJ1cCcsIHRoaXMub25Qb2ludGVydXAuYmluZCh0aGlzKSk7XG4gIH1cbiAgdXBkYXRlKCk6IHZvaWQge1xuICAgIGNvbnN0IHsgZCB9ID0gc3ZnVmFyaWFibGVXaWR0aExpbmUuY29tcHV0ZShcbiAgICAgIC4uLnN2Z1ZhcmlhYmxlV2lkdGhMaW5lLnNtb290aCh0aGlzLnBvaW50cywgNClcbiAgICApO1xuICAgIHRoaXMubXVzdFRhcmdldC5zZXRBdHRyaWJ1dGUoJ2QnLCBkKTtcbiAgfVxufVxuXG4oKCk6IHZvaWQgPT4ge1xuICBjb25zdCBlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ3N2ZyNjYW52YXMnKTtcbiAgaWYgKCEoZWwgaW5zdGFuY2VvZiBTVkdTVkdFbGVtZW50KSkge1xuICAgIHRocm93IEVycm9yKCdNaXNzaW5nIGNhbnZhcyBlbGVtZW50Jyk7XG4gIH1cbiAgbmV3IERyYXdpbmdIYW5kbGVyKGVsKS5pbnN0YWxsKCk7XG4gIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ3BvaW50ZXJtb3ZlJywgZSA9PiB7XG4gICAgY29uc3QgZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcHJlc3N1cmUnKTtcbiAgICBpZiAoIWVsKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGVsLnRleHRDb250ZW50ID0gZS5wcmVzc3VyZS50b1N0cmluZygpO1xuICB9KTtcbiAgZWwuYWRkRXZlbnRMaXN0ZW5lcigncG9pbnRlcm1vdmUnLCBlID0+IHtcbiAgICBjb25zdCBlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwb2ludGVyLXR5cGUnKTtcbiAgICBpZiAoIWVsKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGVsLnRleHRDb250ZW50ID0gZS5wb2ludGVyVHlwZTtcbiAgfSk7XG59KSgpO1xuIl0sInNvdXJjZVJvb3QiOiIifQ==