!function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=7)}([function(t,e,r){"use strict";r.r(e);var n=r(6);r.d(e,"util",(function(){return n}));var o=r(2);r.d(e,"vector2",(function(){return o}));var i=r(3);r.d(e,"computeSidePoints",(function(){return i.b})),r.d(e,"compute",(function(){return i.a}));var u=r(4);for(var a in u)["default","util","vector2","computeSidePoints","compute"].indexOf(a)<0&&function(t){r.d(e,t,(function(){return u[t]}))}(a);var c=r(5);r.d(e,"smoothOnce",(function(){return c.b})),r.d(e,"smooth",(function(){return c.a}))},function(t,e,r){"use strict";function n(t){return t+8-8}r.d(e,"a",(function(){return n}))},function(t,e,r){"use strict";function n(){for(var t=0,e=1;e<arguments.length;e+=1){var r=e-1<0||arguments.length<=e-1?void 0:arguments[e-1],n=e<0||arguments.length<=e?void 0:arguments[e];t+=Math.sqrt(Math.pow(r.x-n.x,2)+Math.pow(r.y-n.y,2))}return t}r.r(e),r.d(e,"length",(function(){return n}))},function(t,e,r){"use strict";r.d(e,"b",(function(){return i})),r.d(e,"a",(function(){return u}));var n=r(1),o=r(2);function i(t,e){var r=t.w/2;if(!e)return{left:{x:t.x,y:t.y+r},right:{x:t.x,y:t.y-r}};var o=Math.atan((t.y-e.y)/(t.x-e.x)),i=Object(n.a)(Math.sin(o)*r),u=Object(n.a)(Math.cos(o)*r);return{left:{x:t.x-i,y:t.y+u},right:{x:t.x+i,y:t.y-u}}}function u(){for(var t=["M"],e=[],r=arguments.length,n=new Array(r),u=0;u<r;u++)n[u]=arguments[u];for(var a=0;a<n.length;a+=1){var c=i(n[a],n[a-1]||n[a+1]),s=c.left,f=c.right,l=e.slice(a)[0];l&&o.length(l,s)>o.length(l,f)?e.splice(a,0,s,f):e.splice(a,0,f,s)}for(var p=0,h=e;p<h.length;p++){var y=h[p];t.push("".concat(y.x,",").concat(y.y))}var d=t.join(" ");return{d:d}}},function(t,e){},function(t,e,r){"use strict";function n(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function i(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function u(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?i(Object(r),!0).forEach((function(e){a(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function a(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c(){var t,e=[];if(0===arguments.length)return[];e.push(u({},arguments.length<=0?void 0:arguments[0]));for(var r=0;r<arguments.length-1;r++){var n=r<0||arguments.length<=r?void 0:arguments[r],o=r+1<0||arguments.length<=r+1?void 0:arguments[r+1];e.push({x:.75*n.x+.25*o.x,y:.75*n.y+.25*o.y,w:.75*n.w+.25*o.w},{x:.25*n.x+.75*o.x,y:.25*n.y+.75*o.y,w:.25*n.w+.75*o.w})}arguments.length>2&&e.push(u({},(t=arguments.length-1)<0||arguments.length<=t?void 0:arguments[t]));return e}function s(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=t,o=0;o<e;o+=1)r=c.apply(void 0,n(r));return r}r.d(e,"b",(function(){return c})),r.d(e,"a",(function(){return s}))},function(t,e,r){"use strict";function n(t,e){var r=t.getScreenCTM();if(!r)throw new Error("Should has screen CTM.");var n=t.createSVGPoint();return n.x=e.x,n.y=e.y,n.matrixTransform(r.inverse())}r.r(e),r.d(e,"translatePoint",(function(){return n})),r.d(e,"refineFloat",(function(){return o.a}));var o=r(1)},function(t,e,r){t.exports=r(8)},function(t,e,r){"use strict";r.r(e);var n=r(0);function o(t){return function(t){if(Array.isArray(t))return i(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return i(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function u(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function a(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?u(Object(r),!0).forEach((function(e){c(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function c(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var f=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.isDrawing=!1,this.points=[],this.width=20,this.el=e}var e,r,i;return e=t,(r=[{key:"onPointerdown",value:function(t){t.preventDefault(),this.isDrawing=!0,this.points=[];var e=document.createElementNS("http://www.w3.org/2000/svg","path");this.el.appendChild(e),this.target=e}},{key:"mustTarget",get:function(){if(!this.target)throw new Error("Should has target");return this.target}},{key:"onPointermove",value:function(t){var e=this;if(this.isDrawing&&(t.preventDefault(),!(this.lastDrawTime&&Date.now()-this.lastDrawTime<4))){this.lastDrawTime=Date.now();var r=n.util.translatePoint(this.el,t),o={x:r.x,y:r.y,w:t.pressure*this.width},i=this.points.slice(-1)[0];i&&n.vector2.length(i,o)<this.width||(this.points.push(o),"mouse"===t.pointerType&&(this.points=this.points.map((function(t,r,n){return a(a({},t),{},{w:e.width*(r/n.length)})}))),this.update())}}},{key:"onPointerup",value:function(t){t.preventDefault(),this.isDrawing=!1,delete this.target}},{key:"install",value:function(){this.el.addEventListener("pointerdown",this.onPointerdown.bind(this)),this.el.addEventListener("pointermove",this.onPointermove.bind(this)),this.el.addEventListener("pointerup",this.onPointerup.bind(this))}},{key:"update",value:function(){var t=n.compute.apply(n,o(n.smooth(this.points,4))).d;this.mustTarget.setAttribute("d",t)}}])&&s(e.prototype,r),i&&s(e,i),Object.defineProperty(e,"prototype",{writable:!1}),t}();!function(){var t=document.querySelector("svg#canvas");if(!(t instanceof SVGSVGElement))throw Error("Missing canvas element");new f(t).install(),t.addEventListener("pointermove",(function(t){var e=document.querySelector("#pressure");e&&(e.textContent=t.pressure.toString())})),t.addEventListener("pointermove",(function(t){var e=document.querySelector("#pointer-type");e&&(e.textContent=t.pointerType)}))}()}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LnRzIiwid2VicGFjazovLy8uL3NyYy91dGlscy9yZWZpbmVGbG9hdC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvdmVjdG9yMi9sZW5ndGgudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXB1dGUudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3Ntb290aC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvdXRpbHMvdHJhbnNsYXRlUG9pbnQudHMiLCJ3ZWJwYWNrOi8vLy4vZGVtby9pbmRleC50cyJdLCJuYW1lcyI6WyJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsInJlZmluZUZsb2F0IiwidiIsImxlbmd0aCIsInJldCIsInBhIiwicGIiLCJNYXRoIiwic3FydCIsInBvdyIsIngiLCJ5IiwiY29tcHV0ZVNpZGVQb2ludHMiLCJjdXJyZW50IiwicHJldiIsInciLCJsZWZ0IiwicmlnaHQiLCJhbmdsZSIsImF0YW4iLCJkeCIsInNpbiIsImR5IiwiY29zIiwiY29tcHV0ZSIsIm9wZXJhdGlvbnMiLCJlZGdlUG9pbnRzIiwicG9pbnRzIiwibGFzdExlZnQiLCJzbGljZSIsInZlY3RvcjIiLCJzcGxpY2UiLCJwdXNoIiwiam9pbiIsInNtb290aE9uY2UiLCJwMCIsInAxIiwic21vb3RoIiwidGltZXMiLCJjb3VudCIsInRyYW5zbGF0ZVBvaW50IiwiZWwiLCJwb2ludCIsIm1hdHJpeCIsImdldFNjcmVlbkNUTSIsIkVycm9yIiwiY3JlYXRlU1ZHUG9pbnQiLCJtYXRyaXhUcmFuc2Zvcm0iLCJpbnZlcnNlIiwiRHJhd2luZ0hhbmRsZXIiLCJpc0RyYXdpbmciLCJ3aWR0aCIsInRoaXMiLCJlIiwicHJldmVudERlZmF1bHQiLCJ0YXJnZXQiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnROUyIsImFwcGVuZENoaWxkIiwibGFzdERyYXdUaW1lIiwiRGF0ZSIsIm5vdyIsInN2Z1ZhcmlhYmxlV2lkdGhMaW5lIiwicHJlc3N1cmUiLCJsYXN0UG9pbnQiLCJwb2ludGVyVHlwZSIsIm1hcCIsImFycmF5IiwidXBkYXRlIiwiYWRkRXZlbnRMaXN0ZW5lciIsIm9uUG9pbnRlcmRvd24iLCJvblBvaW50ZXJtb3ZlIiwib25Qb2ludGVydXAiLCJtdXN0VGFyZ2V0Iiwic2V0QXR0cmlidXRlIiwicXVlcnlTZWxlY3RvciIsIlNWR1NWR0VsZW1lbnQiLCJpbnN0YWxsIiwidGV4dENvbnRlbnQiLCJ0b1N0cmluZyJdLCJtYXBwaW5ncyI6ImFBQ0UsSUFBSUEsRUFBbUIsR0FHdkIsU0FBU0MsRUFBb0JDLEdBRzVCLEdBQUdGLEVBQWlCRSxHQUNuQixPQUFPRixFQUFpQkUsR0FBVUMsUUFHbkMsSUFBSUMsRUFBU0osRUFBaUJFLEdBQVksQ0FDekNHLEVBQUdILEVBQ0hJLEdBQUcsRUFDSEgsUUFBUyxJQVVWLE9BTkFJLEVBQVFMLEdBQVVNLEtBQUtKLEVBQU9ELFFBQVNDLEVBQVFBLEVBQU9ELFFBQVNGLEdBRy9ERyxFQUFPRSxHQUFJLEVBR0pGLEVBQU9ELFFBS2ZGLEVBQW9CUSxFQUFJRixFQUd4Qk4sRUFBb0JTLEVBQUlWLEVBR3hCQyxFQUFvQlUsRUFBSSxTQUFTUixFQUFTUyxFQUFNQyxHQUMzQ1osRUFBb0JhLEVBQUVYLEVBQVNTLElBQ2xDRyxPQUFPQyxlQUFlYixFQUFTUyxF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LEVBQUVVLFNBQVNnQixlQUU5QnRDLEVBQUc0QixpQkFBaUIsZUFBZSxTQUFBaEIsR0FDakMsSUFBTVosRUFBS2UsU0FBU21CLGNBQWMsaUJBQzdCbEMsSUFHTEEsRUFBR3FDLFlBQWN6QixFQUFFWSxnQkFsQnZCIiwiZmlsZSI6ImluZGV4LjRkNTNmZjVlNDhlZGZhNTM5YzcyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDcpO1xuIiwiaW1wb3J0ICogYXMgdXRpbCBmcm9tICcuL3V0aWxzJztcbmltcG9ydCAqIGFzIHZlY3RvcjIgZnJvbSAnLi92ZWN0b3IyJztcbmV4cG9ydCAqIGZyb20gJy4vY29tcHV0ZSc7XG5leHBvcnQgKiBmcm9tICcuL3R5cGVzJztcbmV4cG9ydCB7IHV0aWwsIHZlY3RvcjIgfTtcbmV4cG9ydCAqIGZyb20gJy4vc21vb3RoJztcbiIsIi8qKiBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL2EvNDM1NTAyNjggKi9cbmV4cG9ydCBmdW5jdGlvbiByZWZpbmVGbG9hdCh2OiBudW1iZXIpOiBudW1iZXIge1xuICByZXR1cm4gdiArIDggLSA4O1xufVxuIiwiaW1wb3J0IHsgVmVjdG9yMiB9IGZyb20gJy4uL3R5cGVzJztcblxuLyoqIExlbmd0aCBiZXR3ZWVuIHBvaW50cyAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxlbmd0aCguLi5wb2ludHM6IFZlY3RvcjJbXSk6IG51bWJlciB7XG4gIGxldCByZXQgPSAwO1xuICBmb3IgKGxldCBpID0gMTsgaSA8IHBvaW50cy5sZW5ndGg7IGkgKz0gMSkge1xuICAgIGNvbnN0IHBhID0gcG9pbnRzW2kgLSAxXTtcbiAgICBjb25zdCBwYiA9IHBvaW50c1tpXTtcbiAgICByZXQgKz0gTWF0aC5zcXJ0KE1hdGgucG93KHBhLnggLSBwYi54LCAyKSArIE1hdGgucG93KHBhLnkgLSBwYi55LCAyKSk7XG4gIH1cbiAgcmV0dXJuIHJldDtcbn1cbiIsImltcG9ydCB7IFBvaW50LCBWZWN0b3IyIH0gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQgeyByZWZpbmVGbG9hdCB9IGZyb20gJy4vdXRpbHMvcmVmaW5lRmxvYXQnO1xuaW1wb3J0ICogYXMgdmVjdG9yMiBmcm9tICcuL3ZlY3RvcjInO1xuXG5leHBvcnQgZnVuY3Rpb24gY29tcHV0ZVNpZGVQb2ludHMoXG4gIGN1cnJlbnQ6IFBvaW50LFxuICBwcmV2PzogUG9pbnRcbik6IHsgbGVmdDogVmVjdG9yMjsgcmlnaHQ6IFZlY3RvcjIgfSB7XG4gIGNvbnN0IHIgPSBjdXJyZW50LncgLyAyO1xuICBpZiAoIXByZXYpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbGVmdDoge1xuICAgICAgICB4OiBjdXJyZW50LngsXG4gICAgICAgIHk6IGN1cnJlbnQueSArIHIsXG4gICAgICB9LFxuICAgICAgcmlnaHQ6IHtcbiAgICAgICAgeDogY3VycmVudC54LFxuICAgICAgICB5OiBjdXJyZW50LnkgLSByLFxuICAgICAgfSxcbiAgICB9O1xuICB9XG4gIGNvbnN0IGFuZ2xlID0gTWF0aC5hdGFuKChjdXJyZW50LnkgLSBwcmV2LnkpIC8gKGN1cnJlbnQueCAtIHByZXYueCkpO1xuICBjb25zdCBkeCA9IHJlZmluZUZsb2F0KE1hdGguc2luKGFuZ2xlKSAqIHIpO1xuICBjb25zdCBkeSA9IHJlZmluZUZsb2F0KE1hdGguY29zKGFuZ2xlKSAqIHIpO1xuICByZXR1cm4ge1xuICAgIGxlZnQ6IHtcbiAgICAgIHg6IGN1cnJlbnQueCAtIGR4LFxuICAgICAgeTogY3VycmVudC55ICsgZHksXG4gICAgfSxcbiAgICByaWdodDoge1xuICAgICAgeDogY3VycmVudC54ICsgZHgsXG4gICAgICB5OiBjdXJyZW50LnkgLSBkeSxcbiAgICB9LFxuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY29tcHV0ZSguLi5wb2ludHM6IFBvaW50W10pOiB7IGQ6IHN0cmluZyB9IHtcbiAgY29uc3Qgb3BlcmF0aW9uczogc3RyaW5nW10gPSBbJ00nXTtcbiAgY29uc3QgZWRnZVBvaW50czogVmVjdG9yMltdID0gW107XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgcG9pbnRzLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgY29uc3QgeyBsZWZ0LCByaWdodCB9ID0gY29tcHV0ZVNpZGVQb2ludHMoXG4gICAgICBwb2ludHNbaV0sXG4gICAgICBwb2ludHNbaSAtIDFdIHx8IHBvaW50c1tpICsgMV1cbiAgICApO1xuICAgIGNvbnN0IGxhc3RMZWZ0ID0gZWRnZVBvaW50cy5zbGljZShpKVswXTtcbiAgICBpZiAoXG4gICAgICBsYXN0TGVmdCAmJlxuICAgICAgdmVjdG9yMi5sZW5ndGgobGFzdExlZnQsIGxlZnQpID4gdmVjdG9yMi5sZW5ndGgobGFzdExlZnQsIHJpZ2h0KVxuICAgICkge1xuICAgICAgZWRnZVBvaW50cy5zcGxpY2UoaSwgMCwgbGVmdCwgcmlnaHQpO1xuICAgIH0gZWxzZSB7XG4gICAgICBlZGdlUG9pbnRzLnNwbGljZShpLCAwLCByaWdodCwgbGVmdCk7XG4gICAgfVxuICB9XG4gIGZvciAoY29uc3QgcCBvZiBlZGdlUG9pbnRzKSB7XG4gICAgb3BlcmF0aW9ucy5wdXNoKGAke3AueH0sJHtwLnl9YCk7XG4gIH1cbiAgY29uc3QgZCA9IG9wZXJhdGlvbnMuam9pbignICcpO1xuICByZXR1cm4geyBkIH07XG59XG4iLCJpbXBvcnQgeyBQb2ludCB9IGZyb20gJy4vdHlwZXMnO1xuXG4vLyBSZWZlcjogaHR0cHM6Ly9naXRodWIuY29tL0phbTMvY2hhaWtpbi1zbW9vdGgvYmxvYi9tYXN0ZXIvaW5kZXguanNcblxuZXhwb3J0IGZ1bmN0aW9uIHNtb290aE9uY2UoLi4ucG9pbnRzOiBQb2ludFtdKTogUG9pbnRbXSB7XG4gIGNvbnN0IHJldDogUG9pbnRbXSA9IFtdO1xuICBpZiAocG9pbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiBbXTtcbiAgfVxuICByZXQucHVzaCh7IC4uLnBvaW50c1swXSB9KTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBwb2ludHMubGVuZ3RoIC0gMTsgaSsrKSB7XG4gICAgY29uc3QgcDAgPSBwb2ludHNbaV07XG4gICAgY29uc3QgcDEgPSBwb2ludHNbaSArIDFdO1xuXG4gICAgcmV0LnB1c2goXG4gICAgICB7XG4gICAgICAgIHg6IDAuNzUgKiBwMC54ICsgMC4yNSAqIHAxLngsXG4gICAgICAgIHk6IDAuNzUgKiBwMC55ICsgMC4yNSAqIHAxLnksXG4gICAgICAgIHc6IHAwLncgKiAwLjc1ICsgcDEudyAqIDAuMjUsXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICB4OiAwLjI1ICogcDAueCArIDAuNzUgKiBwMS54LFxuICAgICAgICB5OiAwLjI1ICogcDAueSArIDAuNzUgKiBwMS55LFxuICAgICAgICB3OiBwMC53ICogMC4yNSArIHAxLncgKiAwLjc1LFxuICAgICAgfVxuICAgICk7XG4gIH1cbiAgaWYgKHBvaW50cy5sZW5ndGggPiAyKSB7XG4gICAgcmV0LnB1c2goeyAuLi5wb2ludHNbcG9pbnRzLmxlbmd0aCAtIDFdIH0pO1xuICB9XG4gIHJldHVybiByZXQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzbW9vdGgocG9pbnRzOiBQb2ludFtdLCB0aW1lcyA9IDEpOiBQb2ludFtdIHtcbiAgbGV0IHJldCA9IHBvaW50cztcbiAgZm9yIChsZXQgY291bnQgPSAwOyBjb3VudCA8IHRpbWVzOyBjb3VudCArPSAxKSB7XG4gICAgcmV0ID0gc21vb3RoT25jZSguLi5yZXQpO1xuICB9XG4gIHJldHVybiByZXQ7XG59XG4iLCJleHBvcnQgZnVuY3Rpb24gdHJhbnNsYXRlUG9pbnQoXG4gIGVsOiBTVkdTVkdFbGVtZW50LFxuICBwb2ludDogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9XG4pOiBET01Qb2ludCB7XG4gIGNvbnN0IG1hdHJpeCA9IGVsLmdldFNjcmVlbkNUTSgpO1xuXG4gIGlmICghbWF0cml4KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdTaG91bGQgaGFzIHNjcmVlbiBDVE0uJyk7XG4gIH1cbiAgY29uc3QgcCA9IGVsLmNyZWF0ZVNWR1BvaW50KCk7XG4gIHAueCA9IHBvaW50Lng7XG4gIHAueSA9IHBvaW50Lnk7XG4gIHJldHVybiBwLm1hdHJpeFRyYW5zZm9ybShtYXRyaXguaW52ZXJzZSgpKTtcbn1cbiIsImltcG9ydCAqIGFzIHN2Z1ZhcmlhYmxlV2lkdGhMaW5lIGZyb20gJ0AnO1xuaW1wb3J0IHsgUG9pbnQgfSBmcm9tICdAJztcblxuY2xhc3MgRHJhd2luZ0hhbmRsZXIge1xuICBwdWJsaWMgZWw6IFNWR1NWR0VsZW1lbnQ7XG4gIHB1YmxpYyBpc0RyYXdpbmcgPSBmYWxzZTtcbiAgcHVibGljIHBvaW50czogc3ZnVmFyaWFibGVXaWR0aExpbmUuUG9pbnRbXSA9IFtdO1xuICBwdWJsaWMgdGFyZ2V0PzogU1ZHUGF0aEVsZW1lbnQ7XG4gIHB1YmxpYyB3aWR0aCA9IDIwO1xuICBwdWJsaWMgbGFzdERyYXdUaW1lPzogbnVtYmVyO1xuXG4gIHB1YmxpYyBjb25zdHJ1Y3RvcihlbDogU1ZHU1ZHRWxlbWVudCkge1xuICAgIHRoaXMuZWwgPSBlbDtcbiAgfVxuICBvblBvaW50ZXJkb3duKGU6IFBvaW50ZXJFdmVudCk6IHZvaWQge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB0aGlzLmlzRHJhd2luZyA9IHRydWU7XG4gICAgdGhpcy5wb2ludHMgPSBbXTtcbiAgICBjb25zdCB0YXJnZXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoXG4gICAgICAnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLFxuICAgICAgJ3BhdGgnXG4gICAgKTtcbiAgICB0aGlzLmVsLmFwcGVuZENoaWxkKHRhcmdldCk7XG4gICAgdGhpcy50YXJnZXQgPSB0YXJnZXQ7XG4gIH1cbiAgZ2V0IG11c3RUYXJnZXQoKTogU1ZHUGF0aEVsZW1lbnQge1xuICAgIGlmICghdGhpcy50YXJnZXQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignU2hvdWxkIGhhcyB0YXJnZXQnKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMudGFyZ2V0O1xuICB9XG4gIG9uUG9pbnRlcm1vdmUoZTogUG9pbnRlckV2ZW50KTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLmlzRHJhd2luZykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgaWYgKHRoaXMubGFzdERyYXdUaW1lICYmIERhdGUubm93KCkgLSB0aGlzLmxhc3REcmF3VGltZSA8IDQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5sYXN0RHJhd1RpbWUgPSBEYXRlLm5vdygpO1xuICAgIGNvbnN0IHsgeCwgeSB9ID0gc3ZnVmFyaWFibGVXaWR0aExpbmUudXRpbC50cmFuc2xhdGVQb2ludCh0aGlzLmVsLCBlKTtcbiAgICBjb25zdCB3ID0gZS5wcmVzc3VyZSAqIHRoaXMud2lkdGg7XG4gICAgY29uc3QgcDogUG9pbnQgPSB7IHgsIHksIHcgfTtcbiAgICBjb25zdCBsYXN0UG9pbnQgPSB0aGlzLnBvaW50cy5zbGljZSgtMSlbMF07XG4gICAgaWYgKFxuICAgICAgbGFzdFBvaW50ICYmXG4gICAgICBzdmdWYXJpYWJsZVdpZHRoTGluZS52ZWN0b3IyLmxlbmd0aChsYXN0UG9pbnQsIHApIDwgdGhpcy53aWR0aFxuICAgICkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLnBvaW50cy5wdXNoKHApO1xuICAgIGlmIChlLnBvaW50ZXJUeXBlID09PSAnbW91c2UnKSB7XG4gICAgICB0aGlzLnBvaW50cyA9IHRoaXMucG9pbnRzLm1hcCgodiwgaSwgYXJyYXkpID0+ICh7XG4gICAgICAgIC4uLnYsXG4gICAgICAgIHc6IHRoaXMud2lkdGggKiAoaSAvIGFycmF5Lmxlbmd0aCksXG4gICAgICB9KSk7XG4gICAgfVxuICAgIHRoaXMudXBkYXRlKCk7XG4gIH1cbiAgb25Qb2ludGVydXAoZTogUG9pbnRlckV2ZW50KTogdm9pZCB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIHRoaXMuaXNEcmF3aW5nID0gZmFsc2U7XG4gICAgZGVsZXRlIHRoaXMudGFyZ2V0O1xuICB9XG4gIGluc3RhbGwoKTogdm9pZCB7XG4gICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKCdwb2ludGVyZG93bicsIHRoaXMub25Qb2ludGVyZG93bi5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ3BvaW50ZXJtb3ZlJywgdGhpcy5vblBvaW50ZXJtb3ZlLmJpbmQodGhpcykpO1xuICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcigncG9pbnRlcnVwJywgdGhpcy5vblBvaW50ZXJ1cC5iaW5kKHRoaXMpKTtcbiAgfVxuICB1cGRhdGUoKTogdm9pZCB7XG4gICAgY29uc3QgeyBkIH0gPSBzdmdWYXJpYWJsZVdpZHRoTGluZS5jb21wdXRlKFxuICAgICAgLi4uc3ZnVmFyaWFibGVXaWR0aExpbmUuc21vb3RoKHRoaXMucG9pbnRzLCA0KVxuICAgICk7XG4gICAgdGhpcy5tdXN0VGFyZ2V0LnNldEF0dHJpYnV0ZSgnZCcsIGQpO1xuICB9XG59XG5cbigoKTogdm9pZCA9PiB7XG4gIGNvbnN0IGVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcignc3ZnI2NhbnZhcycpO1xuICBpZiAoIShlbCBpbnN0YW5jZW9mIFNWR1NWR0VsZW1lbnQpKSB7XG4gICAgdGhyb3cgRXJyb3IoJ01pc3NpbmcgY2FudmFzIGVsZW1lbnQnKTtcbiAgfVxuICBuZXcgRHJhd2luZ0hhbmRsZXIoZWwpLmluc3RhbGwoKTtcbiAgZWwuYWRkRXZlbnRMaXN0ZW5lcigncG9pbnRlcm1vdmUnLCBlID0+IHtcbiAgICBjb25zdCBlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwcmVzc3VyZScpO1xuICAgIGlmICghZWwpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZWwudGV4dENvbnRlbnQgPSBlLnByZXNzdXJlLnRvU3RyaW5nKCk7XG4gIH0pO1xuICBlbC5hZGRFdmVudExpc3RlbmVyKCdwb2ludGVybW92ZScsIGUgPT4ge1xuICAgIGNvbnN0IGVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3BvaW50ZXItdHlwZScpO1xuICAgIGlmICghZWwpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZWwudGV4dENvbnRlbnQgPSBlLnBvaW50ZXJUeXBlO1xuICB9KTtcbn0pKCk7XG4iXSwic291cmNlUm9vdCI6IiJ9