!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){t.exports=n(1)},function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"translatePoint",function(){return a}),n.d(r,"refineFloat",function(){return u});var i={};n.r(i),n.d(i,"length",function(){return s});var o={};function a(t,e){var n=t.getScreenCTM();if(!n)throw new Error("Should has screen CTM.");var r=t.createSVGPoint();return r.x=e.x,r.y=e.y,r.matrixTransform(n.inverse())}function u(t){return t+8-8}function s(){for(var t=0,e=1;e<arguments.length;e+=1){var n=e-1<0||arguments.length<=e-1?void 0:arguments[e-1],r=e<0||arguments.length<=e?void 0:arguments[e];t+=Math.sqrt(Math.pow(n.x-r.x,2)+Math.pow(n.y-r.y,2))}return t}function c(t,e){var n=t.w/2;if(!e)return{left:{x:t.x,y:t.y+n},right:{x:t.x,y:t.y-n}};var r=Math.atan((t.y-e.y)/(t.x-e.x)),i=u(Math.sin(r)*n),o=u(Math.cos(r)*n);return{left:{x:t.x-i,y:t.y+o},right:{x:t.x+i,y:t.y-o}}}function l(){for(var t=["M"],e=[],n=0;n<arguments.length;n+=1){var r=c(n<0||arguments.length<=n?void 0:arguments[n],(n-1<0||arguments.length<=n-1?void 0:arguments[n-1])||(n+1<0||arguments.length<=n+1?void 0:arguments[n+1])),i=r.left,o=r.right,a=e.slice(n)[0];a&&s(a,i)>s(a,o)?e.splice(n,0,i,o):e.splice(n,0,o,i)}for(var u=0,l=e;u<l.length;u++){var f=l[u];t.push("".concat(f.x,",").concat(f.y))}return{d:t.join(" ")}}function f(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function p(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(n,!0).forEach(function(e){v(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function v(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d(){var t,e=[];if(0===arguments.length)return[];e.push(p({},arguments.length<=0?void 0:arguments[0]));for(var n=0;n<arguments.length-1;n++){var r=n<0||arguments.length<=n?void 0:arguments[n],i=n+1<0||arguments.length<=n+1?void 0:arguments[n+1];e.push({x:.75*r.x+.25*i.x,y:.75*r.y+.25*i.y,w:.75*r.w+.25*i.w},{x:.25*r.x+.75*i.x,y:.25*r.y+.75*i.y,w:.25*r.w+.75*i.w})}arguments.length>2&&e.push(p({},(t=arguments.length-1)<0||arguments.length<=t?void 0:arguments[t]));return e}function y(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=t,r=0;r<e;r+=1)n=d.apply(void 0,f(n));return n}function g(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function w(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n.r(o),n.d(o,"util",function(){return r}),n.d(o,"vector2",function(){return i}),n.d(o,"computeSidePoints",function(){return c}),n.d(o,"compute",function(){return l}),n.d(o,"smoothOnce",function(){return d}),n.d(o,"smooth",function(){return y});var b=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.isDrawing=!1,this.points=[],this.width=20,this.el=e}var e,n,a;return e=t,(n=[{key:"onPointerdown",value:function(t){t.preventDefault(),this.isDrawing=!0,this.points=[];var e=document.createElementNS("http://www.w3.org/2000/svg","path");this.el.appendChild(e),this.target=e}},{key:"onPointermove",value:function(t){if(this.isDrawing&&(t.preventDefault(),!(this.lastDrawTime&&Date.now()-this.lastDrawTime<4))){this.lastDrawTime=Date.now();var e=r.translatePoint(this.el,t),n={x:e.x,y:e.y,w:t.pressure*this.width},o=this.points.slice(-1)[0];o&&i.length(o,n)<this.width||(this.points.push(n),this.update())}}},{key:"onPointerup",value:function(t){t.preventDefault(),this.isDrawing=!1,delete this.target}},{key:"install",value:function(){this.el.addEventListener("pointerdown",this.onPointerdown.bind(this)),this.el.addEventListener("pointermove",this.onPointermove.bind(this)),this.el.addEventListener("pointerup",this.onPointerup.bind(this))}},{key:"update",value:function(){var t=l.apply(o,g(y(this.points,4))).d;this.mustTarget.setAttribute("d",t)}},{key:"mustTarget",get:function(){if(!this.target)throw new Error("Should has target");return this.target}}])&&w(e.prototype,n),a&&w(e,a),t}();!function(){var t=document.querySelector("svg#canvas");if(!(t instanceof SVGSVGElement))throw Error("Missing canvas element");new b(t).install(),t.addEventListener("pointermove",function(t){var e=document.querySelector("#pressure");e&&(e.textContent=t.pressure.toString())})}()}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWxzL3RyYW5zbGF0ZVBvaW50LnRzIiwid2VicGFjazovLy8uL3NyYy91dGlscy9yZWZpbmVGbG9hdC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvdmVjdG9yMi9sZW5ndGgudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXB1dGUudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3Ntb290aC50cyIsIndlYnBhY2s6Ly8vLi9kZW1vL2luZGV4LnRzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwidHJhbnNsYXRlUG9pbnQiLCJlbCIsInBvaW50IiwibWF0cml4IiwiZ2V0U2NyZWVuQ1RNIiwiRXJyb3IiLCJjcmVhdGVTVkdQb2ludCIsIngiLCJ5IiwibWF0cml4VHJhbnNmb3JtIiwiaW52ZXJzZSIsInJlZmluZUZsb2F0IiwidiIsInJldCIsImxlbmd0aCIsInBhIiwicGIiLCJNYXRoIiwic3FydCIsInBvdyIsImNvbXB1dGVTaWRlUG9pbnRzIiwiY3VycmVudCIsInByZXYiLCJ3IiwibGVmdCIsInJpZ2h0IiwiYW5nbGUiLCJhdGFuIiwiZHgiLCJzaW4iLCJkeSIsImNvcyIsImNvbXB1dGUiLCJvcGVyYXRpb25zIiwiZWRnZVBvaW50cyIsImxhc3RMZWZ0Iiwic2xpY2UiLCJzcGxpY2UiLCJwdXNoIiwiam9pbiIsInNtb290aE9uY2UiLCJwMCIsInAxIiwic21vb3RoIiwicG9pbnRzIiwidGltZXMiLCJjb3VudCIsImlzRHJhd2luZyIsIndpZHRoIiwidGhpcyIsImUiLCJwcmV2ZW50RGVmYXVsdCIsInRhcmdldCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudE5TIiwiYXBwZW5kQ2hpbGQiLCJsYXN0RHJhd1RpbWUiLCJEYXRlIiwibm93IiwicHJlc3N1cmUiLCJsYXN0UG9pbnQiLCJ1cGRhdGUiLCJhZGRFdmVudExpc3RlbmVyIiwib25Qb2ludGVyZG93biIsIm9uUG9pbnRlcm1vdmUiLCJvblBvaW50ZXJ1cCIsIm11c3RUYXJnZXQiLCJzZXRBdHRyaWJ1dGUiLCJxdWVyeVNlbGVjdG9yIiwiU1ZHU1ZHRWxlbWVudCIsImluc3RhbGwiLCJ0ZXh0Q29udGVudCIsInRvU3RyaW5nIl0sIm1hcHBpbmdzIjoiYUFDRSxJQUFJQSxFQUFtQixHQUd2QixTQUFTQyxFQUFvQkMsR0FHNUIsR0FBR0YsRUFBaUJFLEdBQ25CLE9BQU9GLEVBQWlCRSxHQUFVQyxRQUduQyxJQUFJQyxFQUFTSixFQUFpQkUsR0FBWSxDQUN6Q0csRUFBR0gsRUFDSEksR0FBRyxFQUNISCxRQUFTLElBVVYsT0FOQUksRUFBUUwsR0FBVU0sS0FBS0osRUFBT0QsUUFBU0MsRUFBUUEsRUFBT0QsUUFBU0YsR0FHL0RHLEVBQU9FLEdBQUksRUFHSkYsRUFBT0QsUUFLZkYsRUFBb0JRLEVBQUlGLEVBR3hCTixFQUFvQlMsRUFBSVYsRUFHeEJDLEVBQW9CVSxFQUFJLFNBQVNSLEVBQVNTLEVBQU1DLEdBQzNDWixFQUFvQmEsRUFBRVgsRUFBU1MsSUFDbENHLE9BQU9DLGVBQWViLEVBQVNTLEVBQU0sQ0FBRUssWUFBWSxFQUFNQyxJQUFLTCxLQUtoRVosRUFBb0JrQixFQUFJLFNBQVNoQixHQUNYLG9CQUFYaUIsUUFBMEJBLE9BQU9DLGFBQzFDTixPQUFPQyxlQUFlYixFQUFTaUIs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QUFPTixLQUFLeEMsR0FDakJtRCxLQUFLWSxhLGtDQUVLWCxHQUNWQSxFQUFFQyxpQkFDRkYsS0FBS0YsV0FBWSxTQUNWRSxLQUFLRyxTLGdDQUdaSCxLQUFLaEQsR0FBRzZELGlCQUFpQixjQUFlYixLQUFLYyxjQUFjdkUsS0FBS3lELE9BQ2hFQSxLQUFLaEQsR0FBRzZELGlCQUFpQixjQUFlYixLQUFLZSxjQUFjeEUsS0FBS3lELE9BQ2hFQSxLQUFLaEQsR0FBRzZELGlCQUFpQixZQUFhYixLQUFLZ0IsWUFBWXpFLEtBQUt5RCxTLCtCQUV4RCxJQUNJM0UsRUFBTSxVQUFvQixFQUM3QixFQUE0QjJFLEtBQUtMLE9BQVEsS0FEdEN0RSxFQUdSMkUsS0FBS2lCLFdBQVdDLGFBQWEsSUFBSzdGLEssaUNBekNsQyxJQUFLMkUsS0FBS0csT0FDUixNQUFNLElBQUkvQyxNQUFNLHFCQUVsQixPQUFPNEMsS0FBS0csWSxpQ0EwQ2hCLFdBQ0UsSUFBTW5ELEVBQUtvRCxTQUFTZSxjQUFjLGNBQ2xDLEtBQU1uRSxhQUFjb0UsZUFDbEIsTUFBTWhFLE1BQU0sMEJBRWQsSUFBSSxFQUFlSixHQUFJcUUsVUFDdkJyRSxFQUFHNkQsaUJBQWlCLGNBQWUsU0FBQVosR0FDakMsSUFBTWpELEVBQUtvRCxTQUFTZSxjQUFjLGFBQzdCbkUsSUFHTEEsRUFBR3NFLFlBQWNyQixFQUFFUyxTQUFTYSxjQVhoQyIsImZpbGUiOiJpbmRleC45YmRkNTM0MjgxNTNkMmM1YzIyNS5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbiIsImV4cG9ydCBmdW5jdGlvbiB0cmFuc2xhdGVQb2ludChcbiAgZWw6IFNWR1NWR0VsZW1lbnQsXG4gIHBvaW50OiB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH1cbik6IERPTVBvaW50IHtcbiAgY29uc3QgbWF0cml4ID0gZWwuZ2V0U2NyZWVuQ1RNKCk7XG5cbiAgaWYgKCFtYXRyaXgpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1Nob3VsZCBoYXMgc2NyZWVuIENUTS4nKTtcbiAgfVxuICBjb25zdCBwID0gZWwuY3JlYXRlU1ZHUG9pbnQoKTtcbiAgcC54ID0gcG9pbnQueDtcbiAgcC55ID0gcG9pbnQueTtcbiAgcmV0dXJuIHAubWF0cml4VHJhbnNmb3JtKG1hdHJpeC5pbnZlcnNlKCkpO1xufVxuIiwiLyoqIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS80MzU1MDI2OCAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlZmluZUZsb2F0KHY6IG51bWJlcik6IG51bWJlciB7XG4gIHJldHVybiB2ICsgOCAtIDg7XG59XG4iLCJpbXBvcnQgeyBWZWN0b3IyIH0gZnJvbSAnLi4vdHlwZXMnO1xuXG4vKiogTGVuZ3RoIGJldHdlZW4gcG9pbnRzICovXG5leHBvcnQgZnVuY3Rpb24gbGVuZ3RoKC4uLnBvaW50czogVmVjdG9yMltdKTogbnVtYmVyIHtcbiAgbGV0IHJldCA9IDA7XG4gIGZvciAobGV0IGkgPSAxOyBpIDwgcG9pbnRzLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgY29uc3QgcGEgPSBwb2ludHNbaSAtIDFdO1xuICAgIGNvbnN0IHBiID0gcG9pbnRzW2ldO1xuICAgIHJldCArPSBNYXRoLnNxcnQoTWF0aC5wb3cocGEueCAtIHBiLngsIDIpICsgTWF0aC5wb3cocGEueSAtIHBiLnksIDIpKTtcbiAgfVxuICByZXR1cm4gcmV0O1xufVxuIiwiaW1wb3J0IHsgUG9pbnQsIFZlY3RvcjIgfSBmcm9tICcuL3R5cGVzJztcbmltcG9ydCB7IHJlZmluZUZsb2F0IH0gZnJvbSAnLi91dGlscy9yZWZpbmVGbG9hdCc7XG5pbXBvcnQgKiBhcyB2ZWN0b3IyIGZyb20gJy4vdmVjdG9yMic7XG5cbmV4cG9ydCBmdW5jdGlvbiBjb21wdXRlU2lkZVBvaW50cyhcbiAgY3VycmVudDogUG9pbnQsXG4gIHByZXY/OiBQb2ludFxuKTogeyBsZWZ0OiBWZWN0b3IyOyByaWdodDogVmVjdG9yMiB9IHtcbiAgY29uc3QgciA9IGN1cnJlbnQudyAvIDI7XG4gIGlmICghcHJldikge1xuICAgIHJldHVybiB7XG4gICAgICBsZWZ0OiB7XG4gICAgICAgIHg6IGN1cnJlbnQueCxcbiAgICAgICAgeTogY3VycmVudC55ICsgcixcbiAgICAgIH0sXG4gICAgICByaWdodDoge1xuICAgICAgICB4OiBjdXJyZW50LngsXG4gICAgICAgIHk6IGN1cnJlbnQueSAtIHIsXG4gICAgICB9LFxuICAgIH07XG4gIH1cbiAgY29uc3QgYW5nbGUgPSBNYXRoLmF0YW4oKGN1cnJlbnQueSAtIHByZXYueSkgLyAoY3VycmVudC54IC0gcHJldi54KSk7XG4gIGNvbnN0IGR4ID0gcmVmaW5lRmxvYXQoTWF0aC5zaW4oYW5nbGUpICogcik7XG4gIGNvbnN0IGR5ID0gcmVmaW5lRmxvYXQoTWF0aC5jb3MoYW5nbGUpICogcik7XG4gIHJldHVybiB7XG4gICAgbGVmdDoge1xuICAgICAgeDogY3VycmVudC54IC0gZHgsXG4gICAgICB5OiBjdXJyZW50LnkgKyBkeSxcbiAgICB9LFxuICAgIHJpZ2h0OiB7XG4gICAgICB4OiBjdXJyZW50LnggKyBkeCxcbiAgICAgIHk6IGN1cnJlbnQueSAtIGR5LFxuICAgIH0sXG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjb21wdXRlKC4uLnBvaW50czogUG9pbnRbXSk6IHsgZDogc3RyaW5nIH0ge1xuICBjb25zdCBvcGVyYXRpb25zOiBzdHJpbmdbXSA9IFsnTSddO1xuICBjb25zdCBlZGdlUG9pbnRzOiBWZWN0b3IyW10gPSBbXTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBwb2ludHMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICBjb25zdCB7IGxlZnQsIHJpZ2h0IH0gPSBjb21wdXRlU2lkZVBvaW50cyhcbiAgICAgIHBvaW50c1tpXSxcbiAgICAgIHBvaW50c1tpIC0gMV0gfHwgcG9pbnRzW2kgKyAxXVxuICAgICk7XG4gICAgY29uc3QgbGFzdExlZnQgPSBlZGdlUG9pbnRzLnNsaWNlKGkpWzBdO1xuICAgIGlmIChcbiAgICAgIGxhc3RMZWZ0ICYmXG4gICAgICB2ZWN0b3IyLmxlbmd0aChsYXN0TGVmdCwgbGVmdCkgPiB2ZWN0b3IyLmxlbmd0aChsYXN0TGVmdCwgcmlnaHQpXG4gICAgKSB7XG4gICAgICBlZGdlUG9pbnRzLnNwbGljZShpLCAwLCBsZWZ0LCByaWdodCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGVkZ2VQb2ludHMuc3BsaWNlKGksIDAsIHJpZ2h0LCBsZWZ0KTtcbiAgICB9XG4gIH1cbiAgZm9yIChjb25zdCBwIG9mIGVkZ2VQb2ludHMpIHtcbiAgICBvcGVyYXRpb25zLnB1c2goYCR7cC54fSwke3AueX1gKTtcbiAgfVxuICBjb25zdCBkID0gb3BlcmF0aW9ucy5qb2luKCcgJyk7XG4gIHJldHVybiB7IGQgfTtcbn1cbiIsImltcG9ydCB7IFBvaW50IH0gZnJvbSAnLi90eXBlcyc7XG5cbi8vIFJlZmVyOiBodHRwczovL2dpdGh1Yi5jb20vSmFtMy9jaGFpa2luLXNtb290aC9ibG9iL21hc3Rlci9pbmRleC5qc1xuXG5leHBvcnQgZnVuY3Rpb24gc21vb3RoT25jZSguLi5wb2ludHM6IFBvaW50W10pOiBQb2ludFtdIHtcbiAgY29uc3QgcmV0OiBQb2ludFtdID0gW107XG4gIGlmIChwb2ludHMubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG4gIHJldC5wdXNoKHsgLi4ucG9pbnRzWzBdIH0pO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IHBvaW50cy5sZW5ndGggLSAxOyBpKyspIHtcbiAgICBjb25zdCBwMCA9IHBvaW50c1tpXTtcbiAgICBjb25zdCBwMSA9IHBvaW50c1tpICsgMV07XG5cbiAgICByZXQucHVzaChcbiAgICAgIHtcbiAgICAgICAgeDogMC43NSAqIHAwLnggKyAwLjI1ICogcDEueCxcbiAgICAgICAgeTogMC43NSAqIHAwLnkgKyAwLjI1ICogcDEueSxcbiAgICAgICAgdzogcDAudyAqIDAuNzUgKyBwMS53ICogMC4yNSxcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIHg6IDAuMjUgKiBwMC54ICsgMC43NSAqIHAxLngsXG4gICAgICAgIHk6IDAuMjUgKiBwMC55ICsgMC43NSAqIHAxLnksXG4gICAgICAgIHc6IHAwLncgKiAwLjI1ICsgcDEudyAqIDAuNzUsXG4gICAgICB9XG4gICAgKTtcbiAgfVxuICBpZiAocG9pbnRzLmxlbmd0aCA+IDIpIHtcbiAgICByZXQucHVzaCh7IC4uLnBvaW50c1twb2ludHMubGVuZ3RoIC0gMV0gfSk7XG4gIH1cbiAgcmV0dXJuIHJldDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNtb290aChwb2ludHM6IFBvaW50W10sIHRpbWVzID0gMSk6IFBvaW50W10ge1xuICBsZXQgcmV0ID0gcG9pbnRzO1xuICBmb3IgKGxldCBjb3VudCA9IDA7IGNvdW50IDwgdGltZXM7IGNvdW50ICs9IDEpIHtcbiAgICByZXQgPSBzbW9vdGhPbmNlKC4uLnJldCk7XG4gIH1cbiAgcmV0dXJuIHJldDtcbn1cbiIsImltcG9ydCAqIGFzIHN2Z1ZhcmlhYmxlV2lkdGhMaW5lIGZyb20gJ0AnO1xuaW1wb3J0IHsgUG9pbnQgfSBmcm9tICdAJztcblxuY2xhc3MgRHJhd2luZ0hhbmRsZXIge1xuICBwdWJsaWMgZWw6IFNWR1NWR0VsZW1lbnQ7XG4gIHB1YmxpYyBpc0RyYXdpbmcgPSBmYWxzZTtcbiAgcHVibGljIHBvaW50czogc3ZnVmFyaWFibGVXaWR0aExpbmUuUG9pbnRbXSA9IFtdO1xuICBwdWJsaWMgdGFyZ2V0PzogU1ZHUGF0aEVsZW1lbnQ7XG4gIHB1YmxpYyB3aWR0aCA9IDIwO1xuICBwdWJsaWMgbGFzdERyYXdUaW1lPzogbnVtYmVyO1xuXG4gIHB1YmxpYyBjb25zdHJ1Y3RvcihlbDogU1ZHU1ZHRWxlbWVudCkge1xuICAgIHRoaXMuZWwgPSBlbDtcbiAgfVxuICBvblBvaW50ZXJkb3duKGU6IFBvaW50ZXJFdmVudCk6IHZvaWQge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB0aGlzLmlzRHJhd2luZyA9IHRydWU7XG4gICAgdGhpcy5wb2ludHMgPSBbXTtcbiAgICBjb25zdCB0YXJnZXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoXG4gICAgICAnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLFxuICAgICAgJ3BhdGgnXG4gICAgKTtcbiAgICB0aGlzLmVsLmFwcGVuZENoaWxkKHRhcmdldCk7XG4gICAgdGhpcy50YXJnZXQgPSB0YXJnZXQ7XG4gIH1cbiAgZ2V0IG11c3RUYXJnZXQoKTogU1ZHUGF0aEVsZW1lbnQge1xuICAgIGlmICghdGhpcy50YXJnZXQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignU2hvdWxkIGhhcyB0YXJnZXQnKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMudGFyZ2V0O1xuICB9XG4gIG9uUG9pbnRlcm1vdmUoZTogUG9pbnRlckV2ZW50KTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLmlzRHJhd2luZykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgaWYgKHRoaXMubGFzdERyYXdUaW1lICYmIERhdGUubm93KCkgLSB0aGlzLmxhc3REcmF3VGltZSA8IDQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5sYXN0RHJhd1RpbWUgPSBEYXRlLm5vdygpO1xuICAgIGNvbnN0IHsgeCwgeSB9ID0gc3ZnVmFyaWFibGVXaWR0aExpbmUudXRpbC50cmFuc2xhdGVQb2ludCh0aGlzLmVsLCBlKTtcbiAgICBjb25zdCB3ID0gZS5wcmVzc3VyZSAqIHRoaXMud2lkdGg7XG4gICAgY29uc3QgcDogUG9pbnQgPSB7IHgsIHksIHcgfTtcbiAgICBjb25zdCBsYXN0UG9pbnQgPSB0aGlzLnBvaW50cy5zbGljZSgtMSlbMF07XG4gICAgaWYgKFxuICAgICAgbGFzdFBvaW50ICYmXG4gICAgICBzdmdWYXJpYWJsZVdpZHRoTGluZS52ZWN0b3IyLmxlbmd0aChsYXN0UG9pbnQsIHApIDwgdGhpcy53aWR0aFxuICAgICkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLnBvaW50cy5wdXNoKHApO1xuICAgIHRoaXMudXBkYXRlKCk7XG4gIH1cbiAgb25Qb2ludGVydXAoZTogUG9pbnRlckV2ZW50KTogdm9pZCB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIHRoaXMuaXNEcmF3aW5nID0gZmFsc2U7XG4gICAgZGVsZXRlIHRoaXMudGFyZ2V0O1xuICB9XG4gIGluc3RhbGwoKTogdm9pZCB7XG4gICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKCdwb2ludGVyZG93bicsIHRoaXMub25Qb2ludGVyZG93bi5iaW5kKHRoaXMpKTtcbiAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ3BvaW50ZXJtb3ZlJywgdGhpcy5vblBvaW50ZXJtb3ZlLmJpbmQodGhpcykpO1xuICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcigncG9pbnRlcnVwJywgdGhpcy5vblBvaW50ZXJ1cC5iaW5kKHRoaXMpKTtcbiAgfVxuICB1cGRhdGUoKTogdm9pZCB7XG4gICAgY29uc3QgeyBkIH0gPSBzdmdWYXJpYWJsZVdpZHRoTGluZS5jb21wdXRlKFxuICAgICAgLi4uc3ZnVmFyaWFibGVXaWR0aExpbmUuc21vb3RoKHRoaXMucG9pbnRzLCA0KVxuICAgICk7XG4gICAgdGhpcy5tdXN0VGFyZ2V0LnNldEF0dHJpYnV0ZSgnZCcsIGQpO1xuICB9XG59XG5cbigoKTogdm9pZCA9PiB7XG4gIGNvbnN0IGVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcignc3ZnI2NhbnZhcycpO1xuICBpZiAoIShlbCBpbnN0YW5jZW9mIFNWR1NWR0VsZW1lbnQpKSB7XG4gICAgdGhyb3cgRXJyb3IoJ01pc3NpbmcgY2FudmFzIGVsZW1lbnQnKTtcbiAgfVxuICBuZXcgRHJhd2luZ0hhbmRsZXIoZWwpLmluc3RhbGwoKTtcbiAgZWwuYWRkRXZlbnRMaXN0ZW5lcigncG9pbnRlcm1vdmUnLCBlID0+IHtcbiAgICBjb25zdCBlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwcmVzc3VyZScpO1xuICAgIGlmICghZWwpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZWwudGV4dENvbnRlbnQgPSBlLnByZXNzdXJlLnRvU3RyaW5nKCk7XG4gIH0pO1xufSkoKTtcbiJdLCJzb3VyY2VSb290IjoiIn0=